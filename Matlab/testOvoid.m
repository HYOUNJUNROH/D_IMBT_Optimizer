% Test Geometry of Tandem and Ovoid

ovoidR = [  -55.6172  -50.1019  -57.6058;
            -55.3742  -59.7279  -59.9519;
            -55.3286  -61.5397  -60.3961;
            -55.2887  -63.2017  -60.8354;
            -55.2556  -64.6855  -61.2694;
            -55.2300  -65.9882  -61.7074;
            -55.2102  -67.2120  -62.1900;
            -55.1944  -68.4057  -62.7183;
            -55.1842  -69.5466  -63.3045;
            -55.1813  -70.6043  -63.9566;
            -55.1870  -71.5389  -64.6720;
            -55.2018  -72.3561  -65.4575;
            -55.2254  -73.0797  -66.3293;
            -55.2588  -73.7086  -67.3005;
            -55.3014  -74.2561  -68.3686;
            -55.3517  -74.7540  -69.5340;
            -55.4083  -75.1759  -70.7526;
            -55.4668  -75.5981  -72.0028;
            -55.5299  -76.1165  -73.3918;
            -55.6086  -76.6022  -75.0205;
            -57.9053  -90.7618 -122.5036]

ovoidL = [  -39.9215  -49.5599  -57.8097;
            -39.8263  -59.1842  -60.1607;
            -39.8085  -60.9957  -60.6058;
            -39.7936  -62.6573  -61.0461;
            -39.7821  -64.1407  -61.4809;
            -39.7745  -65.4429  -61.9197;
            -39.7705  -66.6661  -62.4031;
            -39.7692  -67.8590  -62.9323;
            -39.7715  -68.9989  -63.5193;
            -39.7785  -70.0556  -64.1724;
            -39.7907  -70.9888  -64.8888;
            -39.8085  -71.8045  -65.6753;
            -39.8321  -72.5264  -66.5482;
            -39.8619  -73.1533  -67.5205;
            -39.8977  -73.6985  -68.5899;
            -39.9389  -74.1938  -69.7567;
            -39.9839  -74.6131  -70.9766;
            -40.0304  -75.0326  -72.2282;
            -40.0810  -75.5479  -73.6188;
            -40.1428  -76.0300  -75.2493;
            -41.9455  -90.0842 -122.7850];  

tandem = [  -46.9417  -61.7487   88.4682;
            -46.9286  -61.6919   80.1674;
            -47.2124  -61.5059   68.2715;
            -47.2963  -61.2440   58.3346;
            -47.4764  -61.2692   48.5747;
            -47.7030  -61.3917   38.0745;
            -47.8594  -63.3796   24.8478;
            -47.6330  -64.6375   14.9281;
            -47.6264  -68.3409   -1.2962;
            -49.0300  -75.0733  -30.3141];

ss1new = [  -46.9417  -61.7487   88.4682;
            -46.9286  -61.6919   80.1674;
            -47.2124  -61.5059   68.2715];

ovoidL(:,3) = ovoidL(:,3)+82.1710;
ovoidR(:,3) = ovoidR(:,3)+82.1710;

plot3(ovoidR(:,1),ovoidR(:,2),ovoidR(:,3),'--'); %Ovoid R
hold on;
plot3(ovoidL(:,1),ovoidL(:,2),ovoidL(:,3),':'); % Ovoid L
hold on;
plot3(tandem(:,1),tandem(:,2),tandem(:,3)); % Tandem

hold on;
scatter3(ss1new(1,1), ss1new(1,2), ss1new(1,3),50,'.');

diff_ss1= diff(ss1new);
dist= sqrt(diff_ss1(:,1).^2+diff_ss1(:,2).^2+diff_ss1(:,3).^2)
%dist_tot= dist(1); %sum(dist);

pE(1)= ss1new(1,1)+ 3*(ss1new(2,1)-ss1new(1,1));
pE(2)= ss1new(1,2)+ 3*(ss1new(2,2)-ss1new(1,2));
pE(3)= ss1new(1,3)+ 3*(ss1new(2,3)-ss1new(1,3));

pA(1)= ss1new(1,1); pA(2)= ss1new(1,2); pA(3)= ss1new(1,3);

hold on;
scatter3(pE(1), pE(2), pE(3));

hold on;
scatter3(pA(1), pA(2), pA(3));

hold on;
line([pA(1) pE(1)],[pA(2) pE(2)], [pA(3) pE(3)]);

candB_x= pA(1):(pE(1)-pA(1))/1e3:pE(1); 
candB_y= pA(2):(pE(2)-pA(2))/1e3:pE(2); 
candB_z= pA(3):(pE(3)-pA(3))/1e3:pE(3); 

